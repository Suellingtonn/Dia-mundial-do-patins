<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Dia Mundial do Patins - Roller Nordeste</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />

  <style>
    * { box-sizing: border-box; font-family: Arial, sans-serif; }
    body { margin: 0; background: #0b3c6f; color: #fff; overflow-x: hidden; }

    /* ===== Irradia√ß√£o global do sol (overlay na p√°gina toda) ===== */
    :root{
      --sunX: 50vw;
      --sunY: 140px;
      --barroPower: 0.0;
      --sunSize: 110px; /* responsivo via media queries */
    }

    .barro-wash{
      position: fixed; inset: 0; pointer-events: none; z-index: 4;
      opacity: calc(0.10 + (var(--barroPower) * 0.25));
      mix-blend-mode: multiply;
      background: radial-gradient(circle at var(--sunX) var(--sunY),
        rgba(184, 107, 62, 0.55),
        rgba(184, 107, 62, 0.18) 35%,
        rgba(184, 107, 62, 0.00) 65%
      );
      transition: opacity 180ms ease;
    }

    .sun-glow{
      position: fixed; inset: 0; pointer-events: none; z-index: 5;
      mix-blend-mode: screen;
      background: radial-gradient(circle at var(--sunX) var(--sunY),
        rgba(255, 215, 0, 0.28),
        rgba(255, 180, 0, 0.10) 22%,
        rgba(255, 160, 0, 0.00) 55%
      );
    }

    /* ===== HEADER ===== */
    .header{
      background: linear-gradient(180deg, #0d7bdc, #0b3c6f);
      padding: 40px 20px 60px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    .header h1{ font-size: 3rem; margin: 0; font-weight: 900; letter-spacing: 2px; }
    .header h2{ margin: 12px 0 8px; font-size: 1.6rem; color: #b86b3e; font-weight: 800; }
    .header p { margin: 0; font-size: 1rem; letter-spacing: 1px; opacity: 0.95; }

    /* ===== SOL (responsivo via --sunSize) ===== */
    .sun{
      width: var(--sunSize);
      height: var(--sunSize);
      background: radial-gradient(circle, #ffd700, #ffb300);
      border-radius: 50%;
      position: fixed;
      left: 0; top: 0;
      margin: 0;
      z-index: 6;
      box-shadow: 0 0 35px rgba(255, 215, 0, 0.8);
      cursor: grab;
      user-select: none;
      touch-action: none;
      -webkit-user-select: none;
      will-change: transform, box-shadow;
    }
    .sun:active{ cursor: grabbing; }

    /* ===== CACTOS (responsivo por scale) ===== */
    .cactus{
      position: fixed;
      width: 90px;
      height: 150px;
      z-index: 6;
      pointer-events: none;
      filter: drop-shadow(0 12px 18px rgba(0,0,0,0.35));
      transition: filter 250ms ease, transform 250ms ease;
      transform-origin: bottom center;
    }
    .cactus .body{
      position: absolute;
      left: 50%;
      bottom: 0;
      transform: translateX(-50%);
      width: 46px;
      height: 120px;
      border-radius: 28px;
      background: linear-gradient(180deg, #27c06b, #0c7a3f);
      border: 2px solid rgba(255,255,255,0.14);
      box-shadow: inset 0 0 0 2px rgba(0,0,0,0.06);
      transition: background 250ms ease;
    }
    .cactus .arm{
      position: absolute;
      bottom: 34px;
      width: 28px;
      height: 56px;
      border-radius: 20px;
      background: linear-gradient(180deg, #27c06b, #0c7a3f);
      border: 2px solid rgba(255,255,255,0.14);
      transition: background 250ms ease;
    }
    .cactus .arm.left{ left: 10px; transform: rotate(-14deg); transform-origin: bottom center; }
    .cactus .arm.right{ right: 10px; transform: rotate(14deg); transform-origin: bottom center; }

    .cactus .spine{ position: absolute; width: 4px; height: 10px; background: rgba(255,255,255,0.65); border-radius: 2px; opacity: 0.35; }
    .cactus .spine.s1{ left: 34px; bottom: 86px; transform: rotate(18deg); }
    .cactus .spine.s2{ left: 50px; bottom: 64px; transform: rotate(-12deg); }
    .cactus .spine.s3{ left: 40px; bottom: 44px; transform: rotate(8deg); }

    .cactus.burning{ transform: translateY(-2px) scale(1.01); }
    .cactus.burning .body,
    .cactus.burning .arm{ background: linear-gradient(180deg, #d46a2a, #7a2b12); }
    .cactus.burning{ filter: drop-shadow(0 0 18px rgba(255,160,0,0.55)) drop-shadow(0 14px 22px rgba(0,0,0,0.35)); }

    .cactus .flame{
      position: absolute;
      left: 50%;
      bottom: 98px;
      transform: translateX(-50%);
      width: 34px;
      height: 50px;
      opacity: 0;
      pointer-events: none;
      transition: opacity 200ms ease;
      filter: drop-shadow(0 0 10px rgba(255, 120, 0, 0.55));
    }
    .cactus.burning .flame{ opacity: 1; }

    .cactus .flame::before,
    .cactus .flame::after{
      content:"";
      position:absolute; inset:0;
      border-radius: 50% 50% 55% 55%;
      background: radial-gradient(circle at 50% 60%,
        rgba(255,255,255,0.65),
        rgba(255,215,0,0.75) 30%,
        rgba(255,120,0,0.85) 60%,
        rgba(255,80,0,0.0) 72%
      );
      animation: flame 680ms ease-in-out infinite;
    }
    .cactus .flame::after{ inset: 6px 8px 2px 8px; animation-duration: 520ms; opacity: 0.9; }

    @keyframes flame{
      0%   { transform: translateY(2px) scale(0.95) rotate(-2deg); }
      50%  { transform: translateY(-6px) scale(1.05) rotate(2deg); }
      100% { transform: translateY(2px) scale(0.95) rotate(-2deg); }
    }

    /* ===== FORM SECTION ===== */
    .form-section{
      background: linear-gradient(180deg, #0b3c6f, #06294d);
      padding: 34px 16px 44px;
      display: flex;
      justify-content: center;
      position: relative;
      z-index: 1;
    }

    .form-box{
      width: 100%;
      max-width: 920px;
      background: rgba(255,255,255,0.10);
      border: 1px solid rgba(255,255,255,0.18);
      border-radius: 18px;
      box-shadow: 0 15px 35px rgba(0,0,0,0.35);
      padding: 18px;
      overflow: hidden;
      backdrop-filter: blur(8px);
    }

    .form-top{
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
      padding: 8px 8px 14px;
    }

    .form-title{
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 900;
      letter-spacing: 0.5px;
    }
    .form-title span{ font-size: 1.1rem; }

    .btn{
      border: none;
      border-radius: 10px;
      padding: 10px 12px;
      font-weight: 900;
      cursor: pointer;
      transition: transform .15s, box-shadow .2s;
    }
    .btn-primary{
      background: linear-gradient(90deg, #0d7bdc, #b86b3e);
      color: #fff;
    }
    .btn-primary:hover{
      transform: translateY(-1px);
      box-shadow: 0 10px 18px rgba(0,0,0,0.25);
    }

    .note{ padding: 0 8px 14px; opacity: 0.92; font-size: 0.95rem; line-height: 1.4; }

    .iframe-wrap{
      width: 100%;
      background: #fff;
      border-radius: 14px;
      overflow: hidden;
      border: 1px solid rgba(0,0,0,0.10);
    }
    iframe{ width: 100%; height: 1100px; border: 0; display: block; }
    @media (min-width: 768px){ iframe{ height: 1350px; } }

    .footer{
      text-align: center;
      font-size: 0.85rem;
      padding: 20px;
      opacity: 0.85;
      position: relative;
      z-index: 1;
    }

    /* ===== RESPONSIVO ===== */
    @media (max-width: 768px){
      :root{ --sunSize: 96px; }
      .header{ padding: 34px 16px 54px; }
      .header h1{ font-size: 2.2rem; }
      .header h2{ font-size: 1.25rem; }
      .header p { font-size: 0.95rem; }
      .form-section{ padding: 26px 12px 34px; }
      .form-box{ padding: 14px; border-radius: 16px; }
      .cactus{ transform: scale(0.90); }
    }

    @media (max-width: 480px){
      :root{ --sunSize: 84px; }
      .header h1{ font-size: 1.9rem; letter-spacing: 1px; }
      .header h2{ font-size: 1.15rem; }
      .header p { font-size: 0.9rem; }
      .form-title span{ font-size: 1rem; }
      .note{ font-size: 0.9rem; }
      .btn{ width: 100%; }
      .cactus{ transform: scale(0.82); }
      /* Ajusta posi√ß√µes dos cactos no mobile para n√£o "invadir" muito */
      #c3{ top: 92px !important; right: 10px !important; }
      #c2{ right: 10px !important; bottom: 14px !important; }
      #c1{ left: 10px !important; bottom: 14px !important; }
    }
  </style>
</head>

<body>
  <div class="barro-wash" id="barroWash"></div>
  <div class="sun-glow" id="sunGlow"></div>

  <!-- Cactos -->
  <div class="cactus" id="c1" style="left: 18px; bottom: 22px;">
    <div class="flame"></div>
    <div class="arm left"></div>
    <div class="arm right"></div>
    <div class="body"></div>
    <div class="spine s1"></div><div class="spine s2"></div><div class="spine s3"></div>
  </div>

  <div class="cactus" id="c2" style="right: 18px; bottom: 26px;">
    <div class="flame"></div>
    <div class="arm left"></div>
    <div class="arm right"></div>
    <div class="body"></div>
    <div class="spine s1"></div><div class="spine s2"></div><div class="spine s3"></div>
  </div>

  <div class="cactus" id="c3" style="right: 26px; top: 140px;">
    <div class="flame"></div>
    <div class="arm left"></div>
    <div class="arm right"></div>
    <div class="body"></div>
    <div class="spine s1"></div><div class="spine s2"></div><div class="spine s3"></div>
  </div>

  <header class="header" id="header">
    <h1>ROLLER NORDESTE</h1>
    <h2>DIA MUNDIAL DO PATINS</h2>
    <p>Recife ‚Ä¢ Marco Zero ‚Ä¢ 18 e 19 Abril</p>
  </header>

  <section class="form-section">
    <div class="form-box">
      <div class="form-top">
        <div class="form-title">
          <div style="font-size: 22px;">üìù</div>
          <span>Inscri√ß√£o (Google Forms)</span>
        </div>
        <div class="form-actions">
          <button class="btn btn-primary" id="btnAbrir">Abrir em nova aba</button>
        </div>
      </div>

      <div class="note">
        Se o formul√°rio demorar para carregar, clique em <b>‚ÄúAbrir em nova aba‚Äù</b>.
        (Isso √© comum em alguns navegadores no celular.)
      </div>

      <div class="iframe-wrap">
        <iframe
          id="gform"
          src="https://docs.google.com/forms/d/e/1FAIpQLSeMuvCwRx0r9_amb4ZnAOaCzXGSwIUaAIqFW-3dd6m2HtznbA/viewform?embedded=true"
          loading="lazy"
          allowfullscreen
          title="Formul√°rio de inscri√ß√£o - Dia Mundial do Patins"
        >Carregando‚Ä¶</iframe>
      </div>
    </div>
  </section>

  <footer class="footer">
    Evento aberto ‚Ä¢ Traga seu patins ‚Ä¢ Use capacete
  </footer>

  <!-- SOL -->
  <div class="sun" id="sun" aria-label="Sol interativo"></div>

  <script>
    // ===== Bot√£o abrir em nova aba =====
    const formUrl = "https://docs.google.com/forms/d/e/1FAIpQLSeMuvCwRx0r9_amb4ZnAOaCzXGSwIUaAIqFW-3dd6m2HtznbA/viewform";
    document.getElementById("btnAbrir").addEventListener("click", () => {
      window.open(formUrl, "_blank", "noopener,noreferrer");
    });

    // ===== Elementos =====
    const sun = document.getElementById("sun");
    const header = document.getElementById("header");
    const formBox = document.querySelector(".form-box");
    const cacti = Array.from(document.querySelectorAll(".cactus"));

    // ===== Estado =====
    let size = 110;      // lido do CSS (responsivo)
    let R = 55;          // size/2

    let x = 0, y = 0;    // centro do sol (viewport)
    let vx = 0, vy = 0;
    let gravityOn = false;

    const g = 2200;
    const bounce = 0.72;
    const air = 0.992;
    const maxSpeed = 2600;

    // Drag
    let dragging = false;
    let dragOffX = 0, dragOffY = 0;

    // arremesso
    let lastMoveT = null;
    let lastMoveX = null;
    let lastMoveY = null;

    // Animation
    let raf = null;
    let lastT = null;

    // Reset
    let resetTimer = null;
    let initial = { x: 120, y: 210 }; // recalculado no init

    // Cactos
    let CACTUS_TRIGGER_DIST = 150; // recalculado no init (responsivo)
    const cactusState = new Map();

    const clamp = (v, min, max) => Math.max(min, Math.min(max, v));

    function readSunSizeFromCSS(){
      const rect = sun.getBoundingClientRect();
      // se ainda n√£o renderizou, cai pro valor de fallback
      size = Math.max(60, Math.round(rect.width || 110));
      R = size / 2;
      // trigger dist√¢ncia ajusta com o tamanho do sol
      CACTUS_TRIGGER_DIST = Math.round(1.55 * size);
    }

    function setCSSVarsFromSun() {
      document.documentElement.style.setProperty("--sunX", `${x}px`);
      document.documentElement.style.setProperty("--sunY", `${y}px`);
    }

    function setBarroPower(p) {
      document.documentElement.style.setProperty("--barroPower", String(clamp(p, 0, 1)));
    }

    function updateVisuals() {
      sun.style.transform = `translate3d(${x - R}px, ${y - R}px, 0)`;
      updateSunShadow();
      setCSSVarsFromSun();
      updateCactiProximity();
    }

    function updateSunShadow() {
      const rect = header.getBoundingClientRect();
      const centerX = rect.left + rect.width / 2;
      const centerY = rect.top + rect.height / 2;

      const dx = x - centerX;
      const dy = y - centerY;

      const sx = clamp(-dx * 0.05, -18, 18);
      const sy = clamp(-dy * 0.05, -18, 18);

      const dist = Math.sqrt(dx*dx + dy*dy);
      const blur = clamp(22 + dist * 0.03, 22, 55);
      const glow = clamp(0.55 + dist * 0.00035, 0.55, 0.9);

      sun.style.boxShadow =
        `${sx}px ${sy}px ${blur}px rgba(0,0,0,0.28), ` +
        `0 0 ${Math.round(28 + dist*0.03)}px rgba(255,215,0,${glow})`;

      const maxDist = Math.sqrt((rect.width/2)**2 + (rect.height/2)**2);
      setBarroPower(clamp(dist / maxDist, 0, 1));
    }

    function resetAllCacti() {
      for (const el of cacti) {
        el.classList.remove("burning");
        const st = cactusState.get(el.id);
        if (st && st.timer) clearTimeout(st.timer);
        cactusState.set(el.id, { burning:false, timer:null });
      }
    }

    function scheduleReset10s() {
      if (resetTimer) clearTimeout(resetTimer);
      resetTimer = setTimeout(() => {
        stopPhysics();
        sun.style.transition = "transform 800ms cubic-bezier(.2,.9,.2,1), box-shadow 800ms ease";
        x = initial.x; y = initial.y;
        updateVisuals();
        setTimeout(() => { sun.style.transition = ""; }, 850);
        setBarroPower(0);
        resetAllCacti();
      }, 10000);
    }

    function stopPhysics() {
      gravityOn = false;
      lastT = null;
      if (raf) cancelAnimationFrame(raf);
      raf = null;
    }

    function startPhysics() {
      if (raf) return;
      gravityOn = true;
      lastT = null;
      raf = requestAnimationFrame(tick);
    }

    function collideWithWalls() {
      const W = window.innerWidth;
      const H = window.innerHeight;

      if (x - R < 0) { x = R; vx = Math.abs(vx) * bounce; }
      if (x + R > W) { x = W - R; vx = -Math.abs(vx) * bounce; }

      if (y - R < 0) { y = R; vy = Math.abs(vy) * bounce; }
      if (y + R > H) { y = H - R; vy = -Math.abs(vy) * bounce; }
    }

    function collideWithRect(rect) {
      const closestX = clamp(x, rect.left, rect.right);
      const closestY = clamp(y, rect.top, rect.bottom);
      const dx = x - closestX;
      const dy = y - closestY;
      const d2 = dx*dx + dy*dy;
      if (d2 > R*R) return;

      const dist = Math.sqrt(d2) || 0.0001;
      const overlap = R - dist;

      const nx = dx / dist;
      const ny = dy / dist;

      x += nx * overlap;
      y += ny * overlap;

      const vn = vx*nx + vy*ny;
      if (vn < 0) {
        vx = vx - (1 + bounce) * vn * nx;
        vy = vy - (1 + bounce) * vn * ny;
      }
    }

    function tick(t) {
      if (!gravityOn || dragging) { raf = null; return; }

      if (lastT == null) lastT = t;
      const dt = Math.min((t - lastT) / 1000, 0.02);
      lastT = t;

      vy += g * dt;

      vx = clamp(vx, -maxSpeed, maxSpeed);
      vy = clamp(vy, -maxSpeed, maxSpeed);

      x += vx * dt;
      y += vy * dt;

      vx *= air;
      vy *= air;

      collideWithWalls();

      const r = formBox.getBoundingClientRect();
      const inflated = { left: r.left - 6, right: r.right + 6, top: r.top - 6, bottom: r.bottom + 6 };
      collideWithRect(inflated);

      updateVisuals();
      raf = requestAnimationFrame(tick);
    }

    // ===== Cactos =====
    function cactusCenter(el) {
      const r = el.getBoundingClientRect();
      return { cx: r.left + r.width/2, cy: r.top + r.height/2 };
    }

    function igniteCactus(el) {
      const st = cactusState.get(el.id) || { burning:false, timer:null };
      if (st.timer) clearTimeout(st.timer);

      el.classList.add("burning");

      const timer = setTimeout(() => {
        el.classList.remove("burning");
        cactusState.set(el.id, { burning:false, timer:null });
      }, 10000);

      cactusState.set(el.id, { burning:true, timer });
    }

    function updateCactiProximity() {
      for (const el of cacti) {
        const { cx, cy } = cactusCenter(el);
        const dx = x - cx;
        const dy = y - cy;
        const dist = Math.sqrt(dx*dx + dy*dy);
        if (dist <= CACTUS_TRIGGER_DIST) igniteCactus(el);
      }
    }

    // ===== Intera√ß√µes (touchscreen + mouse) =====
    function pointerDown(e) {
      e.preventDefault();
      scheduleReset10s();

      dragging = true;
      stopPhysics();
      sun.setPointerCapture(e.pointerId);

      const rect = sun.getBoundingClientRect();
      const px = e.clientX;
      const py = e.clientY;

      const centerX = rect.left + rect.width/2;
      const centerY = rect.top + rect.height/2;
      dragOffX = px - centerX;
      dragOffY = py - centerY;

      lastMoveT = performance.now();
      lastMoveX = px;
      lastMoveY = py;
    }

    function pointerMove(e) {
      if (!dragging) return;

      const W = window.innerWidth;
      const H = window.innerHeight;

      const px = e.clientX;
      const py = e.clientY;

      x = clamp(px - dragOffX, R, W - R);
      y = clamp(py - dragOffY, R, H - R);

      const now = performance.now();
      const dt = (now - lastMoveT) / 1000;
      if (dt > 0) {
        const dx = px - lastMoveX;
        const dy = py - lastMoveY;
        const pvx = dx / dt;
        const pvy = dy / dt;
        vx = vx * 0.4 + pvx * 0.6;
        vy = vy * 0.4 + pvy * 0.6;
      }

      lastMoveT = now;
      lastMoveX = px;
      lastMoveY = py;

      updateVisuals();
    }

    function pointerUp() {
      if (!dragging) return;
      dragging = false;

      vx = clamp(vx, -1800, 1800);
      vy = clamp(vy, -1800, 1800);
      if (Math.abs(vx) < 40) vx = (Math.random() * 220) - 110;
      if (Math.abs(vy) < 40) vy = 120;

      startPhysics();
      scheduleReset10s();
    }

    // Mouse: hover faz cair
    function pointerEnter(e) {
      if (e.pointerType === "mouse" && !dragging && !gravityOn) {
        vx = (Math.random() * 260) - 130;
        vy = 60;
        startPhysics();
        scheduleReset10s();
      }
    }

    // Touch: tap r√°pido no sol faz cair (n√£o depende de hover)
    let tapStartTime = 0;
    function pointerDownForTap(){ tapStartTime = performance.now(); }
    function pointerUpForTap(e){
      if (e.pointerType !== "touch") return;
      const dt = performance.now() - tapStartTime;
      if (dt < 220 && !dragging && !gravityOn) {
        vx = (Math.random() * 260) - 130;
        vy = 60;
        startPhysics();
        scheduleReset10s();
      }
    }

    // ===== Init responsivo =====
    function init() {
      readSunSizeFromCSS();

      const hr = header.getBoundingClientRect();
      // posi√ß√£o inicial ‚Äúlado esquerdo‚Äù do header, proporcional ao tamanho do sol
      initial.x = hr.left + Math.max(14 + R, 14 + R);
      initial.y = hr.top + Math.max(140, 120 + R);

      // garante que comece dentro da tela
      initial.x = clamp(initial.x, R, window.innerWidth - R);
      initial.y = clamp(initial.y, R, window.innerHeight - R);

      x = initial.x; y = initial.y;
      vx = 0; vy = 0;
      gravityOn = false;

      for (const el of cacti) cactusState.set(el.id, { burning:false, timer:null });

      updateVisuals();
      setBarroPower(0);
    }

    // Pointer Events (mouse + touch + caneta)
    sun.addEventListener("pointerdown", pointerDown);
    window.addEventListener("pointermove", pointerMove, { passive: false });
    window.addEventListener("pointerup", pointerUp);

    sun.addEventListener("pointerenter", pointerEnter);
    sun.addEventListener("pointerdown", pointerDownForTap);
    sun.addEventListener("pointerup", pointerUpForTap);

    window.addEventListener("load", init);
    window.addEventListener("resize", () => {
      // atualiza raio/tamanho no resize tamb√©m
      readSunSizeFromCSS();
      if (!dragging && !gravityOn) init();
      else updateVisuals();
    });
  </script>
</body>
</html>
